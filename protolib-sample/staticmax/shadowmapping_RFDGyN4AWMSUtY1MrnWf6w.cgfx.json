{"version": 1,"name": "shadowmapping.cgfx","samplers":{"shadowMap":{"MinFilter": 9728,"MagFilter": 9728,"WrapS": 33071,"WrapT": 33071}},"parameters":{"skinBones":{"type": "float","rows": 225,"columns": 4},"world":{"type": "float","rows": 4,"columns": 3},"viewTranspose":{"type": "float","rows": 3,"columns": 4},"shadowProjectionTranspose":{"type": "float","rows": 4,"columns": 4},"shadowDepth":{"type": "float","columns": 4},"pixelOffset":{"type": "float","columns": 2},"shadowMap":{"type": "sampler2D"}},"techniques":{"rigid":[{"parameters": ["world","viewTranspose","shadowProjectionTranspose","shadowDepth"],"semantics": ["POSITION"],"states":{"DepthTestEnable": true,"DepthFunc": 515,"DepthMask": true,"CullFaceEnable": false,"BlendEnable": false},"programs": ["vp","fp"]}],"skinned":[{"parameters": ["skinBones","world","viewTranspose","shadowProjectionTranspose","shadowDepth"],"semantics": ["POSITION","ATTR7","ATTR1"],"states":{"DepthTestEnable": true,"DepthFunc": 515,"DepthMask": true,"CullFaceEnable": false,"BlendEnable": false},"programs": ["vp_skinned","fp"]}],"blur":[{"parameters": ["pixelOffset","shadowMap"],"semantics": ["POSITION","TEXCOORD0"],"states":{"DepthTestEnable": false,"DepthMask": false,"CullFaceEnable": false,"BlendEnable": false},"programs": ["vp_blur","fp_blur"]}]},"programs":{"fp_blur":{"type": "fragment","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[8];\nvec4 _ret_0;float _TMP10;float _TMP8;float _TMP11;float _TMP6;float _TMP9;vec4 _TMP4;vec4 _TMP3;vec4 _TMP2;vec4 _TMP1;vec4 _TMP0;vec2 _c0020;float _TMP21;vec2 _c0026;float _TMP27;float _TMP33;vec2 _c0038;float _TMP39;vec2 _c0044;float _TMP45;float _TMP51;float _x0052;float _x0056;float _TMP61;float _x0062;float _x0066;float _TMP71;float _x0072;float _x0076;float _TMP81;float _x0082;float _x0086;float _v0090;float _r0090;float _g0090;float _b0090;float _TMP93;float _x0100;float _x0102;float _x0106;float _x0108;float _x0112;uniform vec2 pixelOffset;uniform sampler2D shadowMap;void main()\n{float _accum;_c0020=tz_TexCoord[0].xy-2.0*pixelOffset;_TMP0=texture2D(shadowMap,_c0020);_TMP21=dot(_TMP0.xyz,vec3(9.68764782E-01,3.07621881E-02,4.73029679E-04));_c0026=tz_TexCoord[0].xy-pixelOffset;_TMP1=texture2D(shadowMap,_c0026);_TMP27=dot(_TMP1.xyz,vec3(9.68764782E-01,3.07621881E-02,4.73029679E-04));_TMP2=texture2D(shadowMap,tz_TexCoord[0].xy);_TMP33=dot(_TMP2.xyz,vec3(9.68764782E-01,3.07621881E-02,4.73029679E-04));_c0038=tz_TexCoord[0].xy+pixelOffset;_TMP3=texture2D(shadowMap,_c0038);_TMP39=dot(_TMP3.xyz,vec3(9.68764782E-01,3.07621881E-02,4.73029679E-04));_c0044=tz_TexCoord[0].xy+2.0*pixelOffset;_TMP4=texture2D(shadowMap,_c0044);_TMP45=dot(_TMP4.xyz,vec3(9.68764782E-01,3.07621881E-02,4.73029679E-04));_x0052=_TMP27-_TMP21;_TMP51=pow(2.71828198,_x0052);_x0056=2.00000003E-01+2.00000003E-01*_TMP51;_TMP9=log2(_x0056);_TMP6=_TMP9*6.93147182E-01;_accum=_TMP21+_TMP6;_x0062=_TMP33-_accum;_TMP61=pow(2.71828198,_x0062);_x0066=1.0+2.00000003E-01*_TMP61;_TMP9=log2(_x0066);_TMP6=_TMP9*6.93147182E-01;_accum=_accum+_TMP6;_x0072=_TMP39-_accum;_TMP71=pow(2.71828198,_x0072);_x0076=1.0+2.00000003E-01*_TMP71;_TMP9=log2(_x0076);_TMP6=_TMP9*6.93147182E-01;_accum=_accum+_TMP6;_x0082=_TMP45-_accum;_TMP81=pow(2.71828198,_x0082);_x0086=1.0+2.00000003E-01*_TMP81;_TMP9=log2(_x0086);_TMP6=_TMP9*6.93147182E-01;_accum=_accum+_TMP6;_TMP11=min(1.0,_accum);_TMP93=max(0.0,_TMP11);_x0100=_TMP93*6.55350000E+04;_v0090=floor(_x0100);_x0102=_v0090/2.04800000E+03;_r0090=floor(_x0102);_x0106=_v0090/2.04800000E+03;_TMP10=floor(_x0106);_TMP8=_v0090-2.04800000E+03*_TMP10;_x0108=_TMP8/32.0;_g0090=floor(_x0108);_x0112=_v0090/32.0;_TMP10=floor(_x0112);_b0090=_v0090-32.0*_TMP10;_ret_0=vec4(_r0090/31.0,_g0090/63.0,_b0090/31.0,1.0);gl_FragColor=_ret_0;}"},"vp_blur":{"type": "vertex","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[8];attribute vec4 ATTR8;attribute vec4 ATTR0;\nvec4 _OUTPosition1;vec2 _OUTUV1;void main()\n{_OUTPosition1=ATTR0;_OUTUV1=ATTR8.xy;tz_TexCoord[0].xy=ATTR8.xy;gl_Position=ATTR0;}"},"fp":{"type": "fragment","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[8];\nvec4 _ret_0;float _TMP2;float _TMP1;float _TMP3;float _v0012;float _r0012;float _g0012;float _b0012;float _TMP15;float _x0022;float _x0024;float _x0028;float _x0030;float _x0034;void main()\n{_TMP3=min(1.0,tz_TexCoord[0].x);_TMP15=max(0.0,_TMP3);_x0022=_TMP15*6.55350000E+04;_v0012=floor(_x0022);_x0024=_v0012/2.04800000E+03;_r0012=floor(_x0024);_x0028=_v0012/2.04800000E+03;_TMP2=floor(_x0028);_TMP1=_v0012-2.04800000E+03*_TMP2;_x0030=_TMP1/32.0;_g0012=floor(_x0030);_x0034=_v0012/32.0;_TMP2=floor(_x0034);_b0012=_v0012-32.0*_TMP2;_ret_0=vec4(_r0012/31.0,_g0012/63.0,_b0012/31.0,1.0);gl_FragColor=_ret_0;}"},"vp_skinned":{"type": "vertex","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[8];attribute vec4 ATTR0;\nstruct SkinTransform{vec4 _X;vec4 _Y;vec4 _Z;};vec4 _OUTPosition1;float _OUTDepth1;vec4 _indices0010;ivec4 _Indices0010;SkinTransform _skinWeightTransform0010;attribute vec4 ATTR7;attribute vec4 ATTR1;uniform vec4 skinBones[225];uniform vec3 world[4];uniform vec4 viewTranspose[3];uniform vec4 shadowProjectionTranspose[4];uniform vec4 shadowDepth;void main()\n{vec4 _skinTempPosition;vec3 _Position;vec4 _worldPosition;vec4 _viewPosition;vec3 _TMP7;_indices0010=ATTR7*vec4(3.0,3.0,3.0,3.0);_Indices0010=ivec4(int(_indices0010.x),int(_indices0010.y),int(_indices0010.z),int(_indices0010.w));_skinWeightTransform0010._X=ATTR1.x*skinBones[_Indices0010.x];_skinWeightTransform0010._Y=ATTR1.x*skinBones[(_Indices0010.x+1)];_skinWeightTransform0010._Z=ATTR1.x*skinBones[(_Indices0010.x+2)];_skinWeightTransform0010._X=_skinWeightTransform0010._X+ATTR1.y*skinBones[_Indices0010.y];_skinWeightTransform0010._Y=_skinWeightTransform0010._Y+ATTR1.y*skinBones[(_Indices0010.y+1)];_skinWeightTransform0010._Z=_skinWeightTransform0010._Z+ATTR1.y*skinBones[(_Indices0010.y+2)];_skinWeightTransform0010._X=_skinWeightTransform0010._X+ATTR1.z*skinBones[_Indices0010.z];_skinWeightTransform0010._Y=_skinWeightTransform0010._Y+ATTR1.z*skinBones[(_Indices0010.z+1)];_skinWeightTransform0010._Z=_skinWeightTransform0010._Z+ATTR1.z*skinBones[(_Indices0010.z+2)];_skinWeightTransform0010._X=_skinWeightTransform0010._X+ATTR1.w*skinBones[_Indices0010.w];_skinWeightTransform0010._Y=_skinWeightTransform0010._Y+ATTR1.w*skinBones[(_Indices0010.w+1)];_skinWeightTransform0010._Z=_skinWeightTransform0010._Z+ATTR1.w*skinBones[(_Indices0010.w+2)];_skinTempPosition=vec4(ATTR0.x,ATTR0.y,ATTR0.z,1.0);_Position.x=dot(_skinTempPosition,_skinWeightTransform0010._X);_Position.y=dot(_skinTempPosition,_skinWeightTransform0010._Y);_Position.z=dot(_skinTempPosition,_skinWeightTransform0010._Z);_TMP7=_Position.x*world[0]+_Position.y*world[1]+_Position.z*world[2]+world[3];_worldPosition=vec4(_TMP7.x,_TMP7.y,_TMP7.z,1.0);_viewPosition.x=dot(_worldPosition,viewTranspose[0]);_viewPosition.y=dot(_worldPosition,viewTranspose[1]);_viewPosition.z=dot(_worldPosition,viewTranspose[2]);_viewPosition.w=1.0;_OUTPosition1.x=dot(_viewPosition,shadowProjectionTranspose[0]);_OUTPosition1.y=dot(_viewPosition,shadowProjectionTranspose[1]);_OUTPosition1.z=dot(_viewPosition,shadowProjectionTranspose[2]);_OUTPosition1.w=dot(_viewPosition,shadowProjectionTranspose[3]);_OUTDepth1=shadowDepth.z*_viewPosition.z+shadowDepth.w;tz_TexCoord[0].x=_OUTDepth1;gl_Position=_OUTPosition1;}"},"vp":{"type": "vertex","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[8];attribute vec4 ATTR0;\nvec4 _OUTPosition1;float _OUTDepth1;uniform vec3 world[4];uniform vec4 viewTranspose[3];uniform vec4 shadowProjectionTranspose[4];uniform vec4 shadowDepth;void main()\n{vec4 _worldPosition;vec4 _viewPosition;vec3 _TMP7;_TMP7=ATTR0.x*world[0]+ATTR0.y*world[1]+ATTR0.z*world[2]+world[3];_worldPosition=vec4(_TMP7.x,_TMP7.y,_TMP7.z,1.0);_viewPosition.x=dot(_worldPosition,viewTranspose[0]);_viewPosition.y=dot(_worldPosition,viewTranspose[1]);_viewPosition.z=dot(_worldPosition,viewTranspose[2]);_viewPosition.w=1.0;_OUTPosition1.x=dot(_viewPosition,shadowProjectionTranspose[0]);_OUTPosition1.y=dot(_viewPosition,shadowProjectionTranspose[1]);_OUTPosition1.z=dot(_viewPosition,shadowProjectionTranspose[2]);_OUTPosition1.w=dot(_viewPosition,shadowProjectionTranspose[3]);_OUTDepth1=shadowDepth.z*_viewPosition.z+shadowDepth.w;tz_TexCoord[0].x=_OUTDepth1;gl_Position=_OUTPosition1;}"}}}